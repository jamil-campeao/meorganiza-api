generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // Mude de "mysql" para "postgresql"
  url      = env("DATABASE_URL")
}

// --- Enums ---
enum TransactionType {
  RECEITA // "receita"
  DESPESA // "despesa"
}

// --- Models ---

model User {
  id                      Int               @id @default(autoincrement()) 
  name                    String            
  email                   String            @unique 
  password                String            
  notificationPreference  String?           
  createdAt               DateTime          @default(now())
  active                  Boolean           @default(true)

  transactions            Transaction[]
  investments             Investment[]
  notifications           Notification[]
  bankStatements          BankStatement[]
  balanceForecasts        BalanceForecast[]
  category                Category[]
}

model Transaction {
  id          Int             @id @default(autoincrement()) 
  type        TransactionType
  value       Decimal         @db.Decimal(10, 2) 
  date        DateTime        
  description String          
  
  user        User            @relation(fields: [userId], references: [id])
  userId      Int
  category    Category        @relation(fields: [categoryId], references: [id])
  categoryId  Int
}


model Category {
  id          Int             @id @default(autoincrement())
  description String          
  type        TransactionType 
  active      Boolean         @default(true)
  user        User            @relation(fields: [userId], references: [id])
  userId      Int

  transactions Transaction[]
}


model Investment {
  id                Int       @id @default(autoincrement())
  type              String    
  description       String   
  quantity          Decimal   @db.Decimal(10, 4) 
  acquisitionValue  Decimal   @db.Decimal(10, 2) 
  acquisitionDate   DateTime  
  active            Boolean   @default(true)

  user    User @relation(fields: [userId], references: [id])
  userId  Int
}


model Notification {
  id      Int       @id @default(autoincrement()) 
  message String   
  sentAt  DateTime  
  read    Boolean   @default(false) 

  user    User      @relation(fields: [userId], references: [id])
  userId  Int
}

model BankStatement {
  id          Int       @id @default(autoincrement()) 
  fileType    String    
  importDate  DateTime 
  fileName    String  

  user   User @relation(fields: [userId], references: [id])
  userId Int
}

model BalanceForecast {
  id            Int      @id @default(autoincrement()) 
  futureBalance Decimal  @db.Decimal(10, 2)
  forecastDate  DateTime 
  
  user   User @relation(fields: [userId], references: [id])
  userId Int
}